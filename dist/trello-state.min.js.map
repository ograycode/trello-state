{"version":3,"sources":["trello-state.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","Object","defineProperty","value","default","on","cards","time","state","forEach","card","clone","JSON","parse","stringify","actions","action","Date","date","data","old","key","filter","length","push","cycleTime","startingLists","endingLists","_this","start","end","list","last","findLast","earliest","findEarliest","Math","abs","getTime","listId","isListBefore","type","listBefore","listAfter"],"mappings":"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","file":"trello-state.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"trelloState\"] = factory();\n\telse\n\t\troot[\"trelloState\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = {\n\t  on: function on(cards, time) {\n\t    var state = [];\n\t    cards.forEach(function (card) {\n\t      var clone = JSON.parse(JSON.stringify(card));\n\t      clone.actions.forEach(function (action) {\n\t        if (time < new Date(Date.parse(action.date)) && action.data.old) {\n\t          for (var key in action.data.old) {\n\t            clone[key] = action.data.old[key];\n\t          }\n\t        }\n\t      });\n\t      clone.actions = clone.actions.filter(function (action) {\n\t        return time > new Date(Date.parse(action.date));\n\t      });\n\t      if (clone.actions.length > 0) {\n\t        state.push(clone);\n\t      }\n\t    });\n\t    return state;\n\t  },\n\t  cycleTime: function cycleTime(card, startingLists, endingLists) {\n\t    var _this = this;\n\t\n\t    var start = void 0,\n\t        end = void 0;\n\t    startingLists.forEach(function (list) {\n\t      var last = _this.findLast(card, list);\n\t      if (!start && last || last > start) {\n\t        start = last;\n\t      }\n\t    });\n\t\n\t    endingLists.forEach(function (list) {\n\t      var earliest = _this.findEarliest(card, list);\n\t      if (!end && earliest || earliest < end) {\n\t        end = earliest;\n\t      }\n\t    });\n\t\n\t    if (!start || !end) {\n\t      return -1;\n\t    }\n\t    return Math.abs(start.getTime() - end.getTime());\n\t  },\n\t  findEarliest: function findEarliest(card, listId) {\n\t    var earliest = void 0;\n\t    var isListBefore = false;\n\t    card.actions.forEach(function (action) {\n\t      var date = new Date(Date.parse(action.date));\n\t      if (action.type === 'createCard' && isListBefore) {\n\t        isListBefore = false;\n\t        earliest = date;\n\t      } else if (action.type === 'updateCard') {\n\t        if (action.data.listBefore && action.data.listBefore.id === listId) {\n\t          //need to find the next action that changed it, or created event.\n\t          isListBefore = true;\n\t        } else if (action.data.listAfter && action.data.listAfter.id === listId) {\n\t          if (!earliest || earliest > date) {\n\t            earliest = date;\n\t          }\n\t        }\n\t      }\n\t    });\n\t    return earliest;\n\t  },\n\t  findLast: function findLast(card, listId) {\n\t    var last = void 0;\n\t    var isListBefore = false;\n\t    card.actions.forEach(function (action) {\n\t      var date = new Date(Date.parse(action.date));\n\t      if (action.type === 'createCard' && isListBefore) {\n\t        isListBefore = false;\n\t        if (!last || last < date) {\n\t          last = date;\n\t        }\n\t      } else if (action.type === 'updateCard') {\n\t        if (action.data.listAfter && action.data.listAfter.id === listId) {\n\t          if (!last || last < date) {\n\t            last = date;\n\t          }\n\t          isListBefore = false;\n\t        } else if (action.data.listBefore.id === listId) {\n\t          // need to find either the last after event or created event.\n\t          isListBefore = true;\n\t        }\n\t      }\n\t    });\n\t    return last;\n\t  }\n\t};\n\n/***/ }\n/******/ ])\n});\n;\n"],"sourceRoot":"/source/"}